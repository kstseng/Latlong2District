{
  "name": "Latlong2district",
  "tagline": "Given a pair of [lat, long], return related information.",
  "body": "### 經緯度轉區里\r\n由Johnson所建議的方法，利用開放資料中各區里的經緯度邊界，便可以透過輸入一(多)組經緯度，去找出此經緯度所屬的區里。\r\n\r\n假使每一筆地址資料都已經轉好經緯度，那就可以透過這個方式直接輸出成「XX區-XX里」的格式。\r\n\r\n### 步驟\r\n首先先從開放資料平台下載村里界圖的檔案。但我忘了來源在哪裡了...\r\n\r\n我有先下載並放在google drive中，檔名為「村里界圖(TWD97經緯度)1050715.zip」，請先下載並解壓縮。\r\n解壓縮後會得到一個資料夾，叫做「村里界圖(TWD97經緯度)1050715」，並且裡面會包含六個檔案。\r\n\r\n分別是\r\n\r\n1. 村(里)名稱_替代字對照表.pdf\r\n2. 村(里)名稱.xlsx\r\n3. Village_NLSC_1050715.dbf\r\n4. Village_NLSC_1050715.prj\r\n5. Village_NLSC_1050715.shp\r\n6. Village_NLSC_1050715.shx\r\n\r\n然後接著就可以開始透過R來處理了。\r\n\r\n*用Windows時，照上述的做法會失敗，不過把資料夾改成英文後，便可以順利執行。*\r\n\r\n```{r}\r\nlibrary(rgdal)\r\n\r\n# 指定路徑到剛解壓縮後資料夾的那一層\r\npathFolder <- \"/Users/kaishentseng/Documents/DataHero-Fire/data/村里界圖(TWD97經緯度)1050715\"\r\n# layer則是設定為此資料夾內的檔案名稱，此檔案名稱有多個同名不同格式的檔案\r\ntw <- readOGR(dsn = pathFolder, layer = \"Village_NLSC_1050715\", encoding = \"big5\")\r\n\r\n# 按照之前所定義，只取高雄市，並將高雄港和軍事用地去除\r\nkaohsiung <- tw[tw$C_Name==\"高雄市\" & !tw$V_Name %in% c(c(\"高雄港\", \"軍事用地\")),] \r\nli <- SpatialPolygons(kaohsiung@polygons)\r\n\r\n# 任取一(多)組經緯度，將每組資料以列的順序儲存成矩陣。\r\ndf <- matrix(c(120.297198, 22.641327, \r\n               120.638338, 22.994389), ncol = 2, byrow = T)\r\ncolnames(df) <- c(\"lat\", \"long\")\r\ndf_sp <- SpatialPoints(df)\r\n\r\n# 做(區-里)名字的向量\r\n# [update - 20160828] \r\n# 以下幾個里是在做的過程中，發現有無法辨別的字，導致出現問號\r\n# 經過反查「村(里)名稱_替代字對照表.pdf」後，再手動修改。\r\nkaohsiung_v_Name <- as.character(kaohsiung$V_Name)\r\nkaohsiung_v_Name[159] <- \"部北里\"\r\nkaohsiung_v_Name[160] <- \"部南里\"\r\nkaohsiung_v_Name[647] <- \"帝埔里\"\r\nkaohsiung_v_Name[724] <- \"峰山里\"\r\nkaohsiung_v_Name[757] <- \"公館里\"\r\ndistrict_li <- paste(kaohsiung$T_Name, kaohsiung_v_Name, sep = \"-\")\r\n\r\n# 比對後回傳結果，結果為一個字串向量，若找不到的資料，該筆會回傳 NA。\r\nresult <- district_li[over(df_sp, li)]\r\n```\r\n\r\n### 好處\r\n透過經緯度的方式，應該就可以不用擔心區里有改名，導致最後合併資料會不一致的情況。",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}